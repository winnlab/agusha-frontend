/*controller*/
define("controller",["can/","can/route/","can/view/","can/map/define/","rConfig"],function(e,t,s,i,o){"use strict";e&&e.__esModule||(e={"default":e}),t&&t.__esModule||(t={"default":t}),s&&s.__esModule||(s={"default":s}),i&&i.__esModule||(i={"default":i}),o&&o.__esModule||(o={"default":o});var n=e["default"],r=(o["default"],n.Control.extend({defaults:{css_path:"css/"}},{init:function(){this.first_call=!0,this.base_url=window.location.protocol+"//"+window.location.host,this.active="active",this.element.on("custom_focus",n.proxy(this.custom_focus,this)),this.window=$(window),this.html_body=$("html, body");var e=$("#modules").find(".module.server");return this.server=e.length,this.module_preload=this.element.find(".module_preload"),this.module_preload.height(this.window.height()),this.server?(e.children().appendTo(this.element),e.remove(),this.after_request()):void System["import"](this.options.css_path+this.options.name+"/index.css!").then(n.proxy(this.request,this))},custom_focus:function(){this.element.hasClass(this.active)&&(this.first_call||this.pageview(),this.first_call=!1,this.sizes(),this.onfocus_scroll())},onfocus_scroll:function(){this.html_body.stop(!0,!1).scrollTop(0)},pageview:function(){var e=document.location.href.split(this.base_url)[1];ga("send","pageview",e)},request:function(){var e,t,s,i,o=this.options.path.server,r=["name","entity_id","param2"],a=this;for(i=r.length;i--;)t=r[i],s=new RegExp(":"+t,"g"),o=o.replace(s,this.options[t]?this.options[t]:"");o=o.replace(/\/+(?=\/)/g,""),e=o.length-1,"/"==o[e]&&(o=o.substr(0,e)),n.ajax({url:"/"+o+"?ajax=true",success:function(e){a.successRequest(e)},error:function(e,t,s){console.error(s)}})},successRequest:function(e){if(e.err)return console.error(err);var t=jadeTemplate.get("user/"+this.options.name+"/content",e.data);this.element.append(t),this.after_request(e.data)},after_request:function(e){this.pageview(),this.variables(),this.plugins(e),this.window.trigger("custom_resize"),this.module_preload.hide(),this.after_init(e),this.server&&$(window).trigger("custom_ready")},after_init:function(e){},variables:function(){},plugins:function(){},sizes:function(){},"{window} custom_resize":"resize","{window} resize":"resize",resize:function(){return this.element.hasClass(this.active)?void this.sizes():!1}}));return{get default(){return r},__esModule:!0}});