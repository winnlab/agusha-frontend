steal("can/util","can/construct",function(t){var n,e=function(n,e,o){return t.bind.call(n,e,o),function(){t.unbind.call(n,e,o)}},o=t.isFunction,s=t.extend,r=t.each,i=[].slice,c=/\{([^\}]+)\}/g,u=t.getObject("$.event.special",[t])||{},l=function(n,e,o,s){return t.delegate.call(n,e,o,s),function(){t.undelegate.call(n,e,o,s)}},a=function(n,o,s,r){return r?l(n,t.trim(r),o,s):e(n,o,s)},h=t.Control=t.Construct({setup:function(){if(t.Construct.setup.apply(this,arguments),t.Control){var n,e=this
e.actions={}
for(n in e.prototype)e._isAction(n)&&(e.actions[n]=e._action(n))}},_shifter:function(n,e){var s="string"==typeof e?n[e]:e
return o(s)||(s=n[s]),function(){return n.called=e,s.apply(n,[this.nodeName?t.$(this):this].concat(i.call(arguments,0)))}},_isAction:function(t){var n=this.prototype[t],e=typeof n
return"constructor"!==t&&("function"===e||"string"===e&&o(this.prototype[n]))&&!!(u[t]||f[t]||/[^\w]/.test(t))},_action:function(e,o){if(c.lastIndex=0,o||!c.test(e)){var s=o?t.sub(e,this._lookup(o)):e
if(!s)return t.dev.log("can/control/control.js: No property found for handling "+e),null
var r=t.isArray(s),i=r?s[1]:s,u=i.split(/\s+/g),l=u.pop()
return{processor:f[l]||n,parts:[i,u.join(" "),l],delegate:r?s[0]:void 0}}},_lookup:function(t){return[t,window]},processors:{},defaults:{}},{setup:function(n,e){var o,r=this.constructor,i=r.pluginName||r._fullName
return this.element=t.$(n),i&&"can_control"!==i&&this.element.addClass(i),o=t.data(this.element,"controls"),o||(o=[],t.data(this.element,"controls",o)),o.push(this),this.options=s({},r.defaults,e),this.on(),[this.element,this.options]},on:function(n,e,o,s){if(!n){this.off()
var r,i,c=this.constructor,u=this._bindings,l=c.actions,h=this.element,f=t.Control._shifter(this,"destroy")
for(r in l)l.hasOwnProperty(r)&&(i=l[r]||c._action(r,this.options,this),i&&(u.control[r]=i.processor(i.delegate||h,i.parts[2],i.parts[1],r,this)))
return t.bind.call(h,"removed",f),u.user.push(function(n){t.unbind.call(n,"removed",f)}),u.user.length}return"string"==typeof n&&(s=o,o=e,e=n,n=this.element),void 0===s&&(s=o,o=e,e=null),"string"==typeof s&&(s=t.Control._shifter(this,s)),this._bindings.user.push(a(n,o,s,e)),this._bindings.user.length},off:function(){var t=this.element[0],n=this._bindings
n&&(r(n.user||[],function(n){n(t)}),r(n.control||{},function(n){n(t)})),this._bindings={user:[],control:{}}},destroy:function(){if(null===this.element)return void t.dev.warn("can/control/control.js: Control already destroyed")
var n,e=this.constructor,o=e.pluginName||e._fullName
this.off(),o&&"can_control"!==o&&this.element.removeClass(o),n=t.data(this.element,"controls"),n.splice(t.inArray(this,n),1),t.trigger(this,"destroyed"),this.element=null}}),f=t.Control.processors
return n=function(n,e,o,s,r){return a(n,e,t.Control._shifter(r,s),o)},r(["change","click","contextmenu","dblclick","keydown","keyup","keypress","mousedown","mousemove","mouseout","mouseover","mouseup","reset","resize","scroll","select","submit","focusin","focusout","mouseenter","mouseleave","touchstart","touchmove","touchcancel","touchend","touchleave","inserted","removed"],function(t){f[t]=n}),h})