/*module/question/questionModel*/
define("module/question/questionModel",["baseModel","can/"],function(e,o){"use strict";e&&e.__esModule||(e={"default":e}),o&&o.__esModule||(o={"default":o});var d=e["default"],s=o["default"],u=s.Model.extend({id:"_id",resource:d.chooseResource("/question"),parseModel:d.parseModel,parseModels:d.parseModels},{});return{get default(){return u},__esModule:!0}});
/*module/question/views/answer.mustache!js/plugins/CanJS/view/mustache/system*/
define("module/question/views/answer.mustache!js/plugins/CanJS/view/mustache/system",["can/view/mustache/mustache"],function(s){return s.view.preloadStringRenderer("module/question/views/answer.mustache",s.Mustache(function(t,e){var i=[];return i.push('<div class="item">\n    <div class="date">'),i.push(s.view.txt(1,"div",0,this,s.Mustache.txt({scope:t,options:e},null,{get:"getDate"},{get:"date"}))),i.push('</div>\n    <div class="item_table">\n        <div class="avatar_column">\n            <div class="avatar"><img '),i.push(s.view.txt(2,"img","src",this,function(){var i=[];return i.push('src="'),i.push(s.view.toStr(s.Mustache.txt({scope:t,options:e,special:!0},null,{get:"user.image.small"})())),i.push('"'),i.join("")})),i.push(' class="rounded"',s.view.pending({scope:t,options:e}),">"),i.push('</div>\n        </div>\n        <div class="content_column">\n            <div class="info">\n                <div class="name">'),i.push(s.view.txt(1,"div",0,this,s.Mustache.txt({scope:t,options:e},null,{get:"user.profile.first_name"}))),i.push(" "),i.push(s.view.txt(1,"div",0,this,s.Mustache.txt({scope:t,options:e},null,{get:"user.profile.last_name"}))),i.push('</div>\n            </div>\n            <div class="text">'),i.push(s.view.txt(0,"div",0,this,s.Mustache.txt({scope:t,options:e},null,{get:"answer"}))),i.push("</div>\n        </div>\n    </div>\n</div>"),i.join("")}))});
/*modules/question/question*/
define("modules/question/question",["controller","module/question/questionModel","core/appState","module/question/views/answer.mustache!","js/plugins/jquery.iframetracker/jquery.iframetracker","bx-slider"],function(e,t,i,n,s,o){"use strict";e&&e.__esModule||(e={"default":e}),t&&t.__esModule||(t={"default":t}),i&&i.__esModule||(i={"default":i}),n&&n.__esModule||(n={"default":n}),s&&s.__esModule||(s={"default":s}),o&&o.__esModule||(o={"default":o});var a=e["default"],r=(t["default"],i["default"]),l=n["default"],u=a.extend({defaults:{viewpath:"/js/app/user/modules/question/views/"}},{variables:function(){this.id="question"!=this.options.id?this.options.id:"undefined"},plugins:function(){var e={type:"mini",height:20},t="{width:145,height:20,st:'rounded',sz:20,ck:1}";VK.Widgets.Like("vk_top_"+this.id,e),VK.Widgets.Like("vk_bottom_"+this.id,e),OK.CONNECT.insertShareWidget("ok_top_"+this.id,document.URL,t),OK.CONNECT.insertShareWidget("ok_bottom_"+this.id,document.URL,t)},after_init:function(){this.id.split("-")[1];this.carousel(),this.initIFrameEvents()},carousel:function(){var e=this;$(".interesting_content",e.element).bxSlider({slideWidth:280,minSlides:2,maxSlides:3,moveSlides:1,slideMargin:10})},".slideRight click":function(){$(".bx-wrapper .bx-next",this.element).trigger("click")},".slideLeft click":function(){$(".bx-wrapper .bx-prev",this.element).trigger("click")},".consultationResponse submit":function(e,t){t.preventDefault();var i=this,n=can.deparam(e.serialize());can.ajax({url:"/question/sendAnswer",type:"POST",data:n,success:function(t){e.find("textarea").val(""),i.renderNewAnswer(n,t)},error:function(e){console.error("error",e)}})},renderNewAnswer:function(e,t){var i=this,n=$(".question_items",i.element);n.append(can.view(l,{answer:e.answer.text,user:r.attr("user").user(),date:t.data.updated},{getDate:function(e){var t=null,e=new Date(e),i=e.getDate(),n=["янв","фев","мар","апр","мая","июн","июл","авг","сен","окт","ноя","дек"],s=n[e.getMonth()];return t=i+" "+s+"."}}))},"{window} scroll":function(){this.element.hasClass("active")&&this.moveBackground()},moveBackground:function(){var e=$(".questionBackground",this.element),t=window.scrollY||$(window).scrollTop(),i="0px";if(e.find("img").length>0){var n=e.height(),s=$(".socialWrapper",this.element).offset().top-n-8;i=s>=t?t+"px":s+"px",e.css({top:i})}},initIFrameEvents:function(){var e=this;$(".social_button.fb iframe",e.element).iframeTracker({blurCallback:function(){e.sendSocialLike("fb")}}),$(".social_button.vk iframe",e.element).iframeTracker({blurCallback:function(){e.sendSocialLike("vk")}}),$(".social_button.ok iframe",e.element).iframeTracker({blurCallback:function(){e.sendSocialLike("ok")}})},sendSocialLike:function(e){can.ajax({url:"/like/socialLike",type:"POST",data:{network:e},success:function(){console.log("success")}})}});return{get default(){return u},__esModule:!0}});
