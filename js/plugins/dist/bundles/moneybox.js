/*js/plugins/moment/locale/ru*/
!function(e){"function"==typeof define&&define.amd?define("js/plugins/moment/locale/ru",["moment"],e):"object"==typeof exports?module.exports=e(require("../moment")):e(window.moment)}(function(e){function _(e,_){var t=e.split("_");return _%10===1&&_%100!==11?t[0]:_%10>=2&&4>=_%10&&(10>_%100||_%100>=20)?t[1]:t[2]}function t(e,t,n){var i={mm:t?"минута_минуты_минут":"минуту_минуты_минут",hh:"час_часа_часов",dd:"день_дня_дней",MM:"месяц_месяца_месяцев",yy:"год_года_лет"};return"m"===n?t?"минута":"минуту":e+" "+_(i[n],+e)}function n(e,_){var t={nominative:"январь_февраль_март_апрель_май_июнь_июль_август_сентябрь_октябрь_ноябрь_декабрь".split("_"),accusative:"января_февраля_марта_апреля_мая_июня_июля_августа_сентября_октября_ноября_декабря".split("_")},n=/D[oD]?(\[[^\[\]]*\]|\s+)+MMMM?/.test(_)?"accusative":"nominative";return t[n][e.month()]}function i(e,_){var t={nominative:"янв_фев_мар_апр_май_июнь_июль_авг_сен_окт_ноя_дек".split("_"),accusative:"янв_фев_мар_апр_мая_июня_июля_авг_сен_окт_ноя_дек".split("_")},n=/D[oD]?(\[[^\[\]]*\]|\s+)+MMMM?/.test(_)?"accusative":"nominative";return t[n][e.month()]}function a(e,_){var t={nominative:"воскресенье_понедельник_вторник_среда_четверг_пятница_суббота".split("_"),accusative:"воскресенье_понедельник_вторник_среду_четверг_пятницу_субботу".split("_")},n=/\[ ?[Вв] ?(?:прошлую|следующую)? ?\] ?dddd/.test(_)?"accusative":"nominative";return t[n][e.day()]}return e.defineLocale("ru",{months:n,monthsShort:i,weekdays:a,weekdaysShort:"вс_пн_вт_ср_чт_пт_сб".split("_"),weekdaysMin:"вс_пн_вт_ср_чт_пт_сб".split("_"),monthsParse:[/^янв/i,/^фев/i,/^мар/i,/^апр/i,/^ма[й|я]/i,/^июн/i,/^июл/i,/^авг/i,/^сен/i,/^окт/i,/^ноя/i,/^дек/i],longDateFormat:{LT:"HH:mm",L:"DD.MM.YYYY",LL:"D MMMM YYYY г.",LLL:"D MMMM YYYY г., LT",LLLL:"dddd, D MMMM YYYY г., LT"},calendar:{sameDay:"[Сегодня в] LT",nextDay:"[Завтра в] LT",lastDay:"[Вчера в] LT",nextWeek:function(){return 2===this.day()?"[Во] dddd [в] LT":"[В] dddd [в] LT"},lastWeek:function(){switch(this.day()){case 0:return"[В прошлое] dddd [в] LT";case 1:case 2:case 4:return"[В прошлый] dddd [в] LT";case 3:case 5:case 6:return"[В прошлую] dddd [в] LT"}},sameElse:"L"},relativeTime:{future:"через %s",past:"%s назад",s:"несколько секунд",m:t,mm:t,h:"час",hh:t,d:"день",dd:t,M:"месяц",MM:t,y:"год",yy:t},meridiemParse:/ночи|утра|дня|вечера/i,isPM:function(e){return/^(дня|вечера)$/.test(e)},meridiem:function(e){return 4>e?"ночи":12>e?"утра":17>e?"дня":"вечера"},ordinal:function(e,_){switch(_){case"M":case"d":case"DDD":return e+"-й";case"D":return e+"-го";case"w":case"W":return e+"-я";default:return e}},week:{dow:1,doy:7}})});
/*modules/moneybox/moneyboxHelpers*/
define("modules/moneybox/moneyboxHelpers",["can/","lodash","moment","js/plugins/moment/locale/ru"],function(e,n,t,r){"use strict";function i(e,n){return o.find(n,function(n){return e<n.points})}function u(e){return"function"==typeof e&&(e=e()),e}e&&e.__esModule||(e={"default":e}),n&&n.__esModule||(n={"default":n}),t&&t.__esModule||(t={"default":t}),r&&r.__esModule||(r={"default":r});var o=(e["default"],n["default"]),a=t["default"];a.locale("ru");var f=a.months(),s={lvl:function(e,n){var e=u(e);return e&&i(e,u(n)).label},isLast:function(e,n,t){return e()==n()-1?t.fn():t.inverse()},isAchived:function(e,n){return Number(e())+200>n()?"_achieve":""},gt:function(e,n,t){return u(e)>u(n)?t.fn():t.inverse()},isStarred:function(e,n,t){return u(e)+200>u(n)?t.fn():t.inverse()},getLvlWidth:function(e,n){var t=200-(+n()-+e());return t>0&&200>t?"width: "+t/200*100+"%;":""},minus:function(e,n){return(u(e)-u(n)).toString()},myPoints:function(e){var n=e().toString(),t="";return o.each(n,function(e){t+='<div class="number"><div class="symbol">'+e+"</div></div>"}),t},monthName:function(e){return f[u(e)-1]},getDate:function(e){return a(u(e)).format("DD.MM.YYYY")},getTime:function(e){return a(u(e)).format("HH:mm")},onWebSite:function(e){e=u(e);var n=a(),t=n.diff(a(e),"years"),r=n.diff(a(e),"months")%12,i=n.diff(a().startOf("month"),"days"),o=a.localeData(),f="";return f+=t?o.relativeTime(t,!0,"yy")+" ":"",f+=r?o.relativeTime(r,!0,"MM")+" ":"",f+=i?o.relativeTime(i,!0,"dd"):""},showPrizes:function(e,n,t){n=+u(n);var r="display: none;",i=+u(t).points;return u(e)?"display: block;":(n+400>=i&&i>=n&&(r="display: block;"),r)},lvlLabel:function(e,n){e=+u(e);var t=+u(n).points;return e+200>=t&&t>=e?"Ваш уровень":e+400>=t&&t>=e?"Ваш следующий уровень":"Уровень"},raffleLable:function(e,n){e=+u(e);var t="",r=+u(n).points;switch(t=e+200>=r&&r>=e?"Вы участвуете в розыгрыше для ":"Розыгрыш для ",u(n).label){case"Новичок":t+="новичков";break;case"Ученик":t+="учеников";break;case"Знаток":t+="знатоков";break;case"Эксперт":t+="экспертов";break;case"Профи":t+="профи"}return t}};return{get default(){return s},__esModule:!0}});
/*modules/moneybox/moneybox*/
define("modules/moneybox/moneybox",["can/","core/appState","controller","modules/moneybox/moneyboxHelpers"],function(e,a,t,i){"use strict";e&&e.__esModule||(e={"default":e}),a&&a.__esModule||(a={"default":a}),t&&t.__esModule||(t={"default":t}),i&&i.__esModule||(i={"default":i});var s=e["default"],n=a["default"],r=t["default"],o=i["default"],c=r.extend({defaults:{}},{variables:function(){this.active="active",this.base_url=window.location.protocol+"//"+window.location.host,this.left_menu=$("#left_menu"),this.winner_selectors=this.element.find(".winner_selector"),this.tab_selectors=this.element.find(".tab_selector"),this.tab_blocks=this.element.find(".tab_block"),this.prizes_buttons=this.element.find(".all_prizes button"),this.prize_image_containers=this.element.find(".prize_image_container"),this.modal=this.element.find(".modal"),this.modal_bg=this.modal.find(".modal_bg")},after_init:function(e){var a=this;this.tab_blocks.filter(":not(.active)").find(".text").hide(),this.module=new s.Map({lvls:e?e.lvls:app.lvls,actions:e?e.actions:app.actions,points:e?e.user?e.user.points:0:app.user?app.user.points:0,year:(new Date).getFullYear(),activatedAt:e?e.user?e.user.activated_at:0:app.user?app.user.activated_at:0,allPrizes:!1,prizes:e?e.prizes:app.prizes});var t,i=$("#moneybox_mustache");t=i.length?i.html():jadeTemplate.get("user/moneybox/moneybox_mustache"),s.view.mustache("moneybox_mustache",t),this.element.find(".moneyBoxWrap").html(s.view("moneybox_mustache",this.module,o)),n.delegate("moneybox","set",s.proxy(a.moneyboxed,a)),this.init_sliders()},init_sliders:function(){var e,a,t=this.element.find(".prizeGroup"),i=this.element.find(".how_it_works .prizeGroup");for(i.data("index",t.length-1),this.images=[],e=t.length;e--;){var s=$(t[e]),n=s.find(".images_inside"),r=n.find(".moneybox_card"),o=Math.ceil(r.length/2);for(this.images[e]={prizeGroup:s,imagesInside:n,cards:[],pages:o,currentPage:1,currentPageSpan:s.find(".currentPage")},a=r.length;a--;){var c=$(r[a]),l=c.find(".card_image_selector");this.images[e].cards[a]={el:c,imageSelectors:l,images:l.length/2,currentImage:1}}s.find(".pages").html(o)}},".moneybox_card .left click":"prev_card_image",".moneybox_card .right click":"next_card_image",prev_card_image:function(e){this.change_card_image(e,"prev",":last-child")},next_card_image:function(e){this.change_card_image(e,"next",":first-child")},change_card_image:function(e,a,t){var i,s,n=e.closest(".prizeGroup").data("index"),r=this.images[n],o=e.closest(".moneybox_card").data("index"),c=r.cards[o],l=c.imageSelectors,a=l.filter(".active")[a]();i=a.length?a:l.filter(t),s=i.data("index"),l.removeClass(this.active),c.el.find(".card_image_"+s).addClass(this.active)},".prizeGroup .left_arrow click":"prev_cards_page",".prizeGroup .right_arrow click":"next_cards_page",prev_cards_page:function(e){var a=e.closest(".prizeGroup").data("index"),t=this.images[a];1==t.currentPage?t.currentPage=t.pages:t.currentPage--,this.change_cards_page(t)},next_cards_page:function(e){var a=e.closest(".prizeGroup").data("index"),t=this.images[a];t.currentPage==t.pages?t.currentPage=1:t.currentPage++,this.change_cards_page(t)},change_cards_page:function(e){var a=2*(e.currentPage-1),t=e.cards[a].el,i=t.position().left;e.imagesInside.css({"margin-left":-(0|i)}),e.currentPageSpan.html(e.currentPage)},".modal_group_card .left click":"prev_modal_image",".modal_group_card .right click":"next_modal_image",prev_modal_image:function(e){var a=e.closest(".modal_group_card"),t=a.find(".card_image_selector"),i=t.filter(".active"),s=i.data("index");if(0==s){var n=a.data("images");s=n-1}else s--;this.change_modal_image(t,s)},next_modal_image:function(e){var a=e.closest(".modal_group_card"),t=a.find(".card_image_selector"),i=t.filter(".active"),s=i.data("index"),n=a.data("images");s==n-1?s=0:s++,this.change_modal_image(t,s)},change_modal_image:function(e,a){e.removeClass(this.active),e.filter(".card_image_"+a).addClass(this.active)},moneyboxed:function(e,a){if(a){var t=this;s.ajax({url:"/moneybox-points",dataType:"json",method:"get"}).done(function(e){t.module.attr("actions",e.data.actions),t.module.attr("points",e.data.points)})}},".moneybox_card .card_image click":function(e){this.modal.addClass(this.active),this.modal_image_container||(this.modal_image_container=$("<div>").attr({"class":"image_container"}),this.modal_bg.append(this.modal_image_container));var a=e.closest(".prizeGroup").data("index"),t=e.closest(".moneybox_card").data("index"),i="modal_group_"+a+"_card_"+t,s=this.images[a].cards[t];this[i]||(this[i]=$("<div>").attr({"class":"modal_group_card "+i,"data-images":s.images}),this.modal_image_container.append(this[i]),this[i].append(s.el.html())),this.modal_image_container.find(".modal_group_card").removeClass(this.active),this[i].addClass(this.active);var n=e.data("index"),r=this[i].find(".card_image_selector");r.removeClass(this.active),r.filter(".card_image_"+n).addClass(this.active)},".prize_image_container .left_arrow click":function(e){var a=e.parent(),t=a.find(".prize_image"),i=a.data("image");1==i?i=t.length:i--,a.data("image",i),t.removeClass(this.active),t.filter(".prize_image_"+i).addClass(this.active)},".prize_image_container .right_arrow click":function(e){var a=e.parent(),t=a.find(".prize_image"),i=a.data("image");i==t.length?i=1:i++,a.data("image",i),t.removeClass(this.active),t.filter(".prize_image_"+i).addClass(this.active)},".tab_block .title click":function(e){var a=e.parent(),t=e.next(),i="slideDown";a.hasClass(this.active)&&(i="slideUp"),t.stop(!0,!1)[i](300),a.toggleClass(this.active)},".tab click":"changeTab",".link-tab click":"changeTab",changeTab:function(e){var a=e.data("tab"),t=e.data("block");if(this.tab_selectors.removeClass(this.active),this.tab_selectors.filter("."+a).addClass(this.active),t){this.tab_blocks.removeClass(this.active),this.tab_blocks.find(".text").stop(!0,!1).slideUp(300);var i=this.tab_blocks.filter("."+t);i.addClass(this.active),i.find(".text").stop(!0,!1).slideDown(300)}this.scrollTop()},".up_button click":"scrollTop",scrollTop:function(){$("html, body").scrollTop(0)},".all_prizes button click":function(e){var a=this.element.find(".all_prizes button");a.removeClass(this.active),e.siblings().addClass(this.active),this.module.attr("allPrizes",!this.module.attr("allPrizes"))},".blueTable thead click":function(e){e.parent().toggleClass(this.active)},".modal .close click":function(){this.modal.removeClass(this.active)},".registration_link click":function(){ga("set","page",decodeURI(document.location.href)),ga("send","event","Registration","Moneybox")},".calendar.winner_selector click":function(e){var a=e.data("index");this.winner_selectors.removeClass(this.active),this.winner_selectors.filter(".winner_selector_"+a).addClass(this.active)},"{window} custom_resize":"custom_resize",custom_resize:function(){this.element.hasClass(this.active)&&this.modal_bg.css({left:this.left_menu.width()})}});return{get default(){return c},__esModule:!0}});
